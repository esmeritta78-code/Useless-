<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Invisible Maze with Blue String Particle Background</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      overflow: hidden;
      background: #000;
      font-family: "Segoe UI", sans-serif;
      color: #e0e0e0;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    #particles-bg {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
    }
    #stage {
      position: relative;
      z-index: 1;
      width: 720px;
      height: 480px;
      background:
        linear-gradient(#0a0f18 1px, transparent 1px),
        linear-gradient(90deg, #0a0f18 1px, transparent 1px),
        #0f1822;
      background-size: 40px 40px;
      box-shadow: inset 0 0 50px #00eaff;
      border-radius: 12px;
      overflow: hidden;
      animation: gridPulse 4s ease-in-out infinite alternate;
    }
    @keyframes gridPulse {
      0%, 100% { filter: brightness(120%); }
      50% { filter: brightness(200%); }
    }
    .hud {
      position: absolute; top: 20px; left: 20px;
      background: rgba(16,24,32,0.8); padding: 12px 16px;
      border-radius: 8px; backdrop-filter: blur(4px);
      box-shadow: 0 0 10px rgba(0,234,255,0.6);
      font-size: 14px;
    }
    .msg {
      position: absolute; top: 20px; right: 20px;
      max-width: 200px; font-size: 14px; text-align: right;
      background: rgba(16,24,32,0.8); padding: 12px 16px;
      border-radius: 8px; backdrop-filter: blur(4px);
      box-shadow: 0 0 10px rgba(255,107,255,0.6);
    }
    .footer {
      position: absolute; bottom: 20px; left: 20px;
      font-size: 12px;
    }
    button {
      background: #1f2d3a; border: none; padding: 8px 14px;
      border-radius: 6px; color: #e0e0e0; cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.5);
    }
    button:hover { background: #273745; }
    .player {
      position: absolute; width: 14px; height: 14px;
      background: radial-gradient(circle, #ff0055, #880022);
      border-radius: 50%; box-shadow: 0 0 12px 4px rgba(255,0,85,0.7);
      transition: box-shadow 0.3s;
    }
    @keyframes shake {
      0%,100% { transform: translate(0,0); }
      20% { transform: translate(-2px,2px); }
      40% { transform: translate(2px,-2px); }
      60% { transform: translate(-2px,2px); }
      80% { transform: translate(2px,-2px); }
    }
    #stage.shake { animation: shake 0.3s ease-in-out; }
  </style>
</head>
<body>
  <canvas id="particles-bg"></canvas>
  <div id="stage">
    <div class="hud">
      <div>Status: <span id="status">Running</span></div>
      <div>Pos: <span id="pos">—</span></div>
      <div>Glitches: <span id="glitch">0</span></div>
    </div>
    <div class="msg">Your avatar glows. The maze stays invisible.</div>
    <div class="footer">
      <button id="reset">Reset (nonsense)</button>
      <span style="margin-left: 10px">Still gloriously pointless.</span>
    </div>
  </div>
  <script>
    // Particle setup
    const canvas = document.getElementById("particles-bg");
    const ctx = canvas.getContext("2d");
    const particles = [];
    const numParticles = 80;

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    for (let i = 0; i < numParticles; i++) {
      particles.push({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        size: Math.random() * 2,
        speedX: (Math.random() - 0.5) * 0.3,
        speedY: (Math.random() - 0.5) * 0.3,
      });
    }

    // Enhanced blue string-like particle animation
    function animateParticles() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      ctx.fillStyle = 'rgba(0,150,255,0.8)';
      particles.forEach(p => {
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
        ctx.fill();
      });

      ctx.strokeStyle = 'rgba(0,200,255,0.2)';
      particles.forEach((p, i) => {
        for (let j = i + 1; j < particles.length; j++) {
          const p2 = particles[j];
          const dx = p.x - p2.x;
          const dy = p.y - p2.y;
          const dist = Math.hypot(dx, dy);
          if (dist < 120) {
            ctx.lineWidth = (1 - dist / 120) * 2;
            ctx.beginPath();
            ctx.moveTo(p.x, p.y);
            ctx.lineTo(p2.x, p2.y);
            ctx.stroke();
          }
        }
      });

      particles.forEach(p => {
        p.x += p.speedX;
        p.y += p.speedY;
        if (p.x < 0 || p.x > canvas.width) p.speedX *= -1;
        if (p.y < 0 || p.y > canvas.height) p.speedY *= -1;
      });

      requestAnimationFrame(animateParticles);
    }
    animateParticles();

    // Maze logic (unchanged)
    const TILE = 40, COLS = 18, ROWS = 12;
    const stage = document.getElementById("stage");
    const posEl = document.getElementById("pos");
    const statusEl = document.getElementById("status");
    const glitchEl = document.getElementById("glitch");
    const resetBtn = document.getElementById("reset");

    let px = 1, py = 1, glitches = 0, cd = 0;
    const player = document.createElement("div");
    player.className = "player";
    stage.appendChild(player);

    function show() {
      posEl.textContent = `${px},${py}`;
      player.style.left = `${px * TILE + TILE / 2 - 7}px`;
      player.style.top = `${py * TILE + TILE / 2 - 7}px`;
      leaveTrail();
    }

    function glitch(msg) {
      glitches++;
      glitchEl.textContent = glitches;
      statusEl.textContent = "Glitched";
      document.querySelector(".msg").textContent = msg;
      stage.classList.add("shake");
      setTimeout(() => stage.classList.remove("shake"), 300);
      setTimeout(() => statusEl.textContent = "Running", 800);
    }

    function leaveTrail() {
      const dot = document.createElement("div");
      Object.assign(dot.style, {
        position: "absolute", width: "8px", height: "8px",
        background: "rgba(255,0,85,0.5)", borderRadius: "50%",
        left: `${px * TILE + TILE / 2 - 4}px`,
        top: `${py * TILE + TILE / 2 - 4}px`,
        opacity: "1", pointerEvents: "none",
        transition: "opacity 0.6s"
      });
      stage.appendChild(dot);
      setTimeout(() => dot.style.opacity = "0", 50);
      setTimeout(() => stage.removeChild(dot), 650);
    }

    function canMove(nx, ny) {
      if (nx < 0 || ny < 0 || nx >= COLS || ny >= ROWS) {
        if (Math.random() < 0.15) { glitch("You escaped? Maybe."); return true; }
        return false;
      }
      if (Math.random() < 0.2) { glitch("Phantom wall glitch"); return true; }
      return true;
    }

    function spawnSpark() {
      if (Math.random() > 0.05) return;
      const rx = Math.floor(Math.random() * COLS),
            ry = Math.floor(Math.random() * ROWS);
      const spark = document.createElement("div");
      Object.assign(spark.style, {
        position: "absolute", width: `${TILE}px`, height: `${TILE}px`,
        left: `${rx * TILE}px`, top: `${ry * TILE}px`,
        boxShadow: "0 0 16px 4px rgba(0,255,255,0.8)",
        borderRadius: "4px", pointerEvents: "none",
        opacity: "1", transition: "opacity 0.4s, transform 0.4s"
      });
      stage.appendChild(spark);
      setTimeout(() => {
        spark.style.opacity = "0";
        spark.style.transform = "scale(0.3)";
        setTimeout(() => stage.removeChild(spark), 400);
      }, 100);
    }

    function step(dx, dy) {
      if (Date.now() < cd) return;
      cd = Date.now() + 80;
      if (Math.random() < 0.08) { dx = -dx; dy = -dy; glitch("Controls reversed"); }
      const nx = px + dx, ny = py + dy;
      if (canMove(nx, ny)) { px = nx; py = ny; }
      else if (Math.random() < 0.05) { px = Math.floor(Math.random() * COLS); py = Math.floor(Math.random() * ROWS); glitch("Quantum jump"); }
      else glitch("You hit nothing.");
      show();
      spawnSpark();
    }

    window.addEventListener("keydown", e => {
      if (e.key === "ArrowUp") { step(0, -1); e.preventDefault(); }
      if (e.key === "ArrowDown") { step(0, 1); e.preventDefault(); }
      if (e.key === "ArrowLeft") { step(-1, 0); e.preventDefault(); }
      if (e.key === "ArrowRight") { step(1, 0); e.preventDefault(); }
      if (e.key.toLowerCase() === "r") reset();
    });

    function reset() {
      px = 1; py = 1; glitches = 0; glitchEl.textContent = "0";
      document.querySelector(".msg").textContent = "Reset — yes, still pointless.";
      statusEl.textContent = "Running";
      show();
    }

    resetBtn.onclick = reset;
    show();
  </script>
</body>
</html>
